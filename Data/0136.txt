오늘까지 컬렉션에 대해 좀 얘기해 보려 그래요 그 예전에 제가 가비지
콜렉션 보다 뭐 맥 카운트가 개인적으로 좋아하는 이유 이런 얘기 많이
했는데
지금으로 보면 은 사실 제가 일하는 회사가 왜 패스 하기 때문에 그렇게
순간순간 리얼타임 4 솔의 이미 똑같아야 되는 그런 성능은 중요하지
않거든요
사실 뭐
완전한 최대로 빠르게 졸다가 가끔은 1초 정도 내려 지는거 먹고야 크게
문제가 아니고 그게 올바른 거라고 생각을 하는데
왠만한 애플리케이션은 추천해서 도 그렇고요 단치 게임이나 리얼타임으로
fm 돌려 자는거 에서 그 올바르지 않을 뿐이죠
어쨌든간에 지금 시스템을 많이 쓰고 있는 상황에서 음 일단 뭐 가비지
컬렉션을 쓸 수밖에 없는 거죠
이제 가비지 컬렉션이 당연히 느릴 수밖에 없어요 생각해보면 왜냐하면
500만 들어갔다가 어느 순간 메모리가 없다 그러면 가비지 컬렉터
들어오면서
이제 모든 오브젝트를 훑으면서 보는 거에요 얘가 여기에서 몇 프랑스가
포함이 되어 있나 뭐 이런식으로 이렇게 움트는 아니고
c 샵 은 조금 몇 현가 레퍼런스 카운트를 유지하는 게 아니었다는
방식이라고 하는데
뭐라 그러더라 제 가족 매체를 1 건데 지금 기억이 잘 안나고
뭐 그냥 고수의 생각하면 더 이상 2개 뿐 객체 오브젝트 오브젝트 를
참조하고 있는 다른 개체가 없으면 그냥 가비지 컬렉션이 되니까 그 때
가비지 컬렉션 해왔고
치우는 거죠 그리고 의 단점은 당연히 볼 수 있겠지만 모든 오브젝트로
회생 하는게 쿨 터에 된다는 게 굉장히 느린 거거든요
그래서
몇년전에 꽤 됐죠 사실을 그 단어에 대해서 가비지 컬렉션의 op 마이
제시를 하고 이제 도입을 한 게 뭐냐면 시즈널 가비지 컬렉션 이에요
물론 이 건은 그 완전히 제대로 떠있는 닷넷 프레임워크에서 되는거고
그 가끔 뭐 엑스퍼트 text 라던가 이런데 들어갔던 닷넷 프레임워크는
컴팩트 프레임워크 라고 해서
조민 배드 쪽으로 들어가는 닷넷 프레임워크 돼 있거든요 거기서는 시즈널
컬렉션 자체가 없었어요
그리고 뭐 유니티에서 도 이제 모노 에서 최근에 이제 실제로 컬렉션
도입해 왔고 그 어떤 일 년 이 년 된다 1년인 0
예 그래서 좀 갈지 그렇죠 빨라진 것도 있는데
시즈널 가비지 컬렉터가 작동하는 방법은 이래요 어떻게 하냐면 물체가
생기면 그 물체에 라이트 타입 을 보는 거에요 오브제 태 그 오브젝트가
생겼다
그러면 그 오브젝트에서 어느정도 시간까지는 이해를 아 이번 생긴지 얼마
안 됐으니까 시즌
지로 라고 하고 영이라고 1 일부터 시작하는 거죠 저는 영이 편할까 00
으로 할게요
시즌 영해 드는 거에요 시즌이라 보면 계절이 잖아요 그럼 0 번개 줘
가장 최근 되죠
그러고 있다가 메모리는 딱 가르쳤을 때
그러면 무조건 치즈는 원에 있는 모베이스 어쨌든 치우는 거에요 가비 커쇼
척 하는 거에요 왜냐면 사람들 프로그램 패턴이 시 샵에서 오브젝트
만들자마자 쓰고 버리는 게 되게 흔한 패턴 이기 때문에 그 최근에
만들어주고 버린 오브젝트가 굉장히 많아요 생각보다 그래서 이걸 딱 채웠을
때 메모리가 충분히 돌아왔구나 그러면 더이상 터치 안하고 계속 진행을
해요 근데 예를 들어서 시즌 0 에 있던 그 오브젝트가 굉장히 오랫동안
따른 개체에 나모 2
그거에 의해서 참조가 되서 올해 버티다 보면 얘네가 시즌 원으로 프로모션
되요 너무 오래 있으니까 다음 그 전 전 단계라고 해서 그 전단계 보내고
그 다음에 시즌 2까지 있을 거야 뭐 그랬어요 제가 생각해 시즈니 3개
인거 같은데 더 일수도 있고
0 1 2 이렇게 있는 거죠 영이가 장치는 거 일이 것보다 조금 더 오래
된거 이가 정말 오래 된거 그래서 이제 세계의 시드니 있잖아요
그러면 가비지 가 딱 들어왔어 가르치 컬렉션이 그러면 뭐 처음에 시즌
빵을 다 지워요 봤는데
어이 때 메모리가 보잖아 그럼 시즌 5 넘어가요 그 시점을 짝 지워요
가비지 컬렉션을 하면 다 지우는 게 아니라 더 이상 참조 안되는거 만
그래서 봐서 메모리가 충분히 충분히 되찾아 왔다 그러면 굳이 멈추고 또
다시 프로세스를 진행하고
그게 아니라면 다시 하나도 마지막 시즌까지 가서 전부다 긁는 거죠 그러면
이게 말 그대로
전부 시즌을 긁는 께 되는 거에요 모든 모든 그 옵 2x 호흡계
되는거예요 그래서 오히려 오브젝트 빨리 만나서 빨리 버리면 c 샤넌은
성능은 오히려 빨라요
그게 아니라 적당히 어중간하게 잡고 있다가 나중에 풀린다
그러면 월 성능 드릴 수가 있어요 뭐 아예 가베 질 안 되는 즉 성능
것이 좋지만요
그래서 이게
그 가비지 컬렉터가 작동하는 원리 에 3장에서 물론 깊게 들어 옵니다
복잡한게 있겠지만 그게 예를 들어 ot 맞으시는 만들어 놓은거 고
4
최근에 이제
원래 이제 그 가비지 컬렉터 직접 호출 수 있는 거 알잖아 시스템 다
dc 나 커 닥트 를 호출하면 은
뭐 그냥 콜렉트 말하며 나라 전체가 콜렉터 할 거고 그다음에 이제 숫자를
매개변수로 봤거든요
그럼 그 매개변수 따라 뭐 0 1 2 모르시고 되면 첫 번째 시즌 두
번째 센서가 지시자 이렇게 알지 컬렉션도 가능하구요
얼마전에 엑셀 신라 잊어 얘기 했잖아요
그 xml 라이즈를 물론 그 캐쉬 해봤고 뭐 액션이 노 나갔고
속도도 빠르게 했고 더 이상 메모리 누수 도 안 나게 한 건 좋은데 그
외에 또 하나의 단점은
저희 파일을 한번 이제 가비지 컬렉터가 할 때마다 아니 시리얼 라이즈를
할 때마다 xml 파일을 가비지 란 일종의 가 나왔어요
일단 그 이유가 리플렉션 시스템을 쓰면 쓸수록 방연이 중간 리플렉션
과정이다 오브젝트를 생성하고 버리는게 많기 때문에 그런 가지가 생기거든요
그래서
이 문제는 그 서버 자체도 찌 굉장히 메모리도 많았고 이것 좀 하는 짓이
많았기 때문에 어느 순간 이가 비즈가 시즌 r1 해서 안 몸으로 시즌
특가 영의 사람으로 일까지 넘어가는 일도 있긴 있더라구요 보면서 아
이렇게 좀 개인적인 입장에서는 솔직히 딱 가비지 가격이니 만큼 생긴다는
것도 알잖아요 그렇게 딱 채워주며 좋잖아요
근데 그러기 위해서 가비지 컬렉터 를 내가 시즌 첫 번째 거에 만 계속
고쳐지는 것도 애매하고 1 입력 값 이제 생긴거 뭐 xml 신라 제
100번 그이 영매 가니까 메모리에서 차라리 그때 그때 치워주고 싶은데
그런 방법이 없는 거에요
그렇다고 가비지 콜렉터를 매번 호출 하기도 그렇고 시즌 그 지금 0번
시즌에 전부다
그래서 생각이 든게 혹시라도
이런게 있으면 어떡하나 생각을 했어요 예를 들어서
뭣이 쪽에서 게임 많이 해보신분들은 게임제작 해보신 분들의 겠지만 우리
스테 rok 터 라고 해 같고
실제 메모리를 10에서 알고계신 하지 않고 스택에서 계속 올린 다음에 뭐
함수 나갈 때 라던가 스코프 나갈 때 그냥 스택 포인터 되도 올라가니까
그러면은 메모리
알로켄 굉장히 빨리 할 수 있잖아요 뭐 엄밀한 이거 다 알고 대신하기
위한 스펙을 쓰는것 드니까 그래서 그 스택 알로 캐릭터 이렇게 보였던
사람들도 있고 아니면 은 진짜 순수하게 스택에 넣지 않고 힙을 놓는 데
힘을 이만큼 미리 잡아주고 그걸 스텝 실험자가 다 포인트가 유지 해 같고
올라간 다음에 그 범위에 넘어갈 때 그냥 이걸 돌려놓는
그 스택 포인터를 원래대로 돌려놓고 따른 그 메모리 필요한 애들이 거의
타지 라이트 할 수 있는
지울 필요가 없는거죠 그냥 막 라이트만 하고 다 쓰다가 스톡 포인터 및
올리는 거니까 그런 식의 패턴을 되게 많이 했었거든요 사실을
그거는 좀 비슷하게 단 능해서
그 스코프 가르치 컬렉션이 있으면서 어떨까 싶어요
예를 들어서 그 아까 말듯이 xml 쉘 아이즈 하는거면 그 함수 호출하기
전에 가비지 컬렉션 새로운 비전을 만드는 거죠 시즌 2라고 해서 그래서
뭐 진씨 스탈 트 쓰이지 한다면 스타트 의 지원 해 같고
거기다가 1 열어두고 다음에 이제 엑셈 의식을 가졌다 호출 하자마자
돌아온 다음에 g 기타 되면 그 계속 코프라 넘어가 어리니까 아니 뭐
따로 호투로 & 고추 해주던가
그러면 알아서 반드시 고요 범위 안에서 스코프가 있던 범위의 생겼던
오브젝트를 다른 위 전에 저장해두고
딱 그게 끝나는 순간 그리 절대 부터 갖고 이미 가비지 컬렉터 컬렉션을
할 수 있는 것 에서 래플스 않는 것들을 가르쳐 클릭 해 버리고
남는 것은 그냥 시즌 지로 로 다시 던 던져주고 이런 식의
호스텔로 페이드 좀 비슷하고 그런 근데 제가 생각하는 거 스택 기반 이제
스코프 기반 가르치 컬렉션 억압의 가리지 컬렉션이 라고 해야죠
그런게 있으면 제 생각에는
그 고성능에 프로그램을 만드는 굉장히 도움이 되지 않을까 싶어요
그리고 이 결을
뭐랄까 그 스코프가 들어가는데 범위 자체가 사실은 쓰레드 하나에만
들어가잖아요 멀티 뚫어야 그 안에 티
실행이 안 된다고 봐야 되나요 뭐 트레이드가 오면은 다른 들에 대해 갈
때 갑작스 코프 가 생기는 거겠죠
그렇게 되면은 프레드 멀티쓰레드 걱정 할 이유도 없고 그 어쨌다는 뭐
시대의 던져 주지 않은 않은 이상 더 그런거 만 쪼금 어떻게 제안을
잘한다면 스레드로 칼처럼 1 뚜레 대해서만 돌고 1 스레드 만 스코프가
생기는 그런 가비지 컬렉션을 지원을 해주면 정말 고성능 프로그램 만들기가
더 좋지 않을까 생각을 해요 그러면 아까 말했듯이 거의 2배가 씨가 b
생기는 것도 그냥 거의 가비지 안만들고 처리 하는 거고 것만큼 아 뭐
즉 망상 있네 물론 달 내내 불을
훑어보며 는 가비지 컬렉터가 좀더 저한테 어떻게 작동하지 더욱이 터보
면은 진짜 알고리즘이 나 이런 걸 보며 는 제 망상 이아이 틀릴수도
있어요 그냥 아예 부 가는거 거나 그 구조상 그럴 수도 있는데 지금은
생각으로는 개인적으로 그런 스코프 기반의 가비지 컬렉션이 가능하면 오히려
정말 성능 빠르고 그때그때 필요는 외고를 지어주고
가비지 더욱 더 많 만들어 뭐 프로모션 안되게 하고 그렇게 할 수 있어서
빠르지 않을까 라는 망산 이 들어서
원래는 그 말만 하고 싶었지만
감시 컨텐츠 니한테 작동하지 얘기를 안하면 또 말이 안될 것 같아서 그게
추가해서 어쩔 수 없이 길어진 포프 tv 오구요
저는 지금 배고프니까 밥먹으로 나 갈래요
보셨습니다
